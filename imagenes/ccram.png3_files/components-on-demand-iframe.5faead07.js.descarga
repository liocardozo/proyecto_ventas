(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[26998],{78579:(e,a,o)=>{const{Iframe:t}=o(96561);e.exports=t},99511:(e,a,o)=>{const t=o(78579);e.exports=t},78397:(e,a,o)=>{var t=o(16270);o(74423);o(96540);const{useState:n,useEffect:s,useRef:r}=o(96540),{bool:l,string:i,func:d,shape:c,number:E}=o(5556),{Modal:m}=o(57937),{VisuallyHidden:_}=o(64679),u=o(46942),f=o(81762),p=o(35122),{trackEvent:g}=o(800),S=o(99511),A=o(81821),{eventTypes:C}=o(65346),{VPP_SEQUENCER_DATADOG_KEY_CASES:T}=o(76147),{REASON_TAG_VALUES:D}=o(66146),{feStatsdHelper:L}=o(44396),{updateOnePayForAllTrack:R,ACTIONS_SEQUENCER_TRACK:b,RENDER_MODES:I}=o(31018),{DEPRECATED_MSG_LOADED:M,DEPRECATED_MSG_REDIRECT:v,DEPRECATED_MSG_NAVIGATE:w,DEPRECATED_MSG_CLOSE:k,DEPRECATED_MSG_SNACKBAR:h,MSG_LOADED:O,MSG_CLOSE:G,MSG_CLOSABLE:N,MSG_SNACKBAR:y,MSG_NAVIGATE:B,MSG_REDIRECT:V,MSG_ASK_SELLER:U,MSG_SCROLL_TO_ELEMENT:K}=C,P=e=>{let{id:a,src:o,isRedirectFlow:l,title:i,show:d,renderMode:c,noScrolling:E,deviceType:C,fallbackConfig:P,statsdConfig:F,isDismissible:x,showSnackbar:W,onDemandIframeClose:q,onDemandIframeUpdate:H,updateComponentsBottomSheet:Q,onCloseVariations:z,onCreateQuestionFromAi:Y,showVariationsError:j,sequencerTrack:$}=e;const J=r(null),X=r(null),Z=r(null),[ee,ae]=n(!1),[oe,te]=n(null),[ne,se]=n(null),re=o&&o.includes("/payments?new_version=true&modal=true&newIndex=true"),le=o&&o.includes("questions-ai"),ie="mobile"===C?le?"small":"card":"large",{fallbackUrl:de,fallbackMessage:ce,timeoutInitialLoad:Ee,timeoutWebviewMessage:me}=P||{},_e=e=>{let{message:a,additionalTags:o={},additionalInfo:t,shouldLogMessage:n}=e;L({key:T.SHOW_SNACKBAR,additionalTags:{snackbar_type:"error",...o},additionalInfo:t,shouldLogMessage:n,statsdConfig:F}),W&&W({message:a,type:"error"})},ue=e=>{let{url:a,target:o,newIsDismissible:t,newFallbackConfig:n,newRenderMode:s,noLoadedCheck:r}=e;if(a&&A({target:a,currentLocation:window.location})){if("parent"===o&&(window.location.href=a),"modal"===o&&H){r||ae(!1),te(null);const e={src:a,isRedirectFlow:!0,fallbackConfig:r?null:n,isDismissible:t};s&&(e.renderMode=s),L({key:T.WEBVIEW_REDIRECT,statsdConfig:F}),H(e)}}else _e({additionalTags:{reason:D.INVALID_REDIRECT_URL},additionalInfo:{url:a,target:o},shouldLogMessage:!0})},fe=()=>{z&&z(),q&&q(),oe&&(g(oe),te(null))},pe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{trackData:a=null,refreshCartIcon:o=!1,shouldUpdateComponents:t=!1,disableClose:n=!1,titleModal:s=null}=e;var r;clearTimeout(J.current),se(s),ae(!0),n&&H({isDismissible:!1}),a&&te({melidata_event:{...a}}),$&&g(R($,b.LOADED)),L({key:T.FLOW_END,additionalTags:{end_case:X.current?`${Z.current}_redirect`:Z.current},statsdConfig:F}),o&&(null===(r=p.freya)||void 0===r||r.emit("cart:refresh")),t&&Q&&Q()},ge=e=>{var a;if(d&&(null!=e&&null!==(a=e.data)&&void 0!==a&&a.type))switch(e.data.type){case M:case O:pe(e.data.data);break;case k:case G:fe();break;case N:H({isDismissible:e.data.enabled});break;case h:case y:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{snackbar:a,close:o}=e;if(a&&W){const{message:e,type:t,delay:n,called_from:s,action:r}=a;o&&fe(),r&&(r.onClick=()=>ue({url:r.redirectUrl,target:"parent"})),W({message:e,type:t,delay:n,called_from:s,action:r})}}(e.data);break;case w:case B:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{url:a,fallback:o,fallback_message:t,timeout:n,timeout_webview_message:s,no_loaded_check:r,is_dismissible:l,render_mode:i}=e;ue({url:a,target:"modal",newRenderMode:i,newFallbackConfig:{...P,fallbackUrl:o,fallbackMessage:t,timeoutInitialLoad:n,timeoutWebviewMessage:s},noLoadedCheck:r,newIsDismissible:l})}(e.data);break;case v:case V:ue({url:e.data.url,target:"parent"});break;case U:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{itemId:a,question:o,snackbar_message:t,track:n}=e;o&&a&&Y&&(fe(),Y({itemId:a,text:o,snackbar_message:t,suggestionTrack:n,source:"webview"}))}(e.data);break;case K:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{selector:a,shouldRaiseErrors:o,actionKey:t}=e;if(a){const e=document.querySelector(a);fe(),e.scrollIntoView({behavior:"smooth",block:"start"}),o&&j(C,t)}}(e.data)}};s((()=>{o&&P&&(J.current=setTimeout((()=>{$&&g(R($)),de&&A({target:de,currentLocation:window.location})?(L({key:T.REDIRECT_TO_FALLBACK,additionalTags:{reason:D.TIMEOUT_INITIAL_LOAD,flow_redirect:Boolean(X.current)},statsdConfig:F}),window.location.href=de):(_e({message:null==ce?void 0:ce.message,additionalTags:{reason:D.TIMEOUT_INITIAL_LOAD,flow_redirect:Boolean(X.current)}}),fe())}),Ee||1e4))}),[o]),s((()=>{var e,a;(d||ae(!1),z&&d)&&(null===(e=document.querySelector(".ui-pdp-backdrop-modal"))||void 0===e||e.setAttribute("style","height:0px"),null===(a=document.querySelectorAll(".andes-modal__overlay")[0])||void 0===a||a.setAttribute("style","height:0px"));return p.addEventListener("message",ge),()=>{p.removeEventListener("message",ge),clearTimeout(J.current)}}),[d]),s((()=>{Z.current=c===I.CONTAINER?"bottom_sheet":"landing",X.current=Boolean(l)}),[c,l]);const Se=u("on-demand-iframe",{"on-demand-iframe--desktop":"large"===ie,"on-demand-iframe--mobile__container":"large"!==ie&&c===I.CONTAINER,"on-demand-iframe--mobile__fullscreen":"large"!==ie&&c===I.FULLSCREEN,"iframe-modal-questions-ai":le,"iframe-modal-redirect-payments":re});return t(m,{open:d,id:a,onClose:fe,type:c===I.FULLSCREEN?"full":ie,title:ne?t(_,{},void 0,ne):i||" ",className:Se,closable:ee&&!1!==x},void 0,t(S,{title:"iframe","data-testid":"iframe-element",src:o,showSpinner:!0,scrolling:E?"no":"auto",forceSpinner:!ee,spinnerClassname:"center-spinner",onLoad:()=>{clearTimeout(J.current),P&&(J.current=setTimeout((()=>{$&&g(R($)),de&&A({target:de,currentLocation:window.location})?(L({key:T.REDIRECT_TO_FALLBACK,additionalTags:{reason:D.TIMEOUT_WEBVIEW_MESSAGE,flow_redirect:Boolean(X.current)},statsdConfig:F}),window.location.href=de):(_e({message:null==ce?void 0:ce.message,additionalTags:{reason:D.TIMEOUT_WEBVIEW_MESSAGE,flow_redirect:Boolean(X.current)}}),fe())}),me||5e3))},onMessage:c===I.FULLSCREEN?()=>{}:f("vpp:on-demand-iframe:resize","height",".ui-pdp-iframe-modal",".andes-modal__header")}))};P.defaultProps={id:"",title:"",renderMode:I.CONTAINER,show:!1,fallbackConfig:null,statsdConfig:null,isDismissible:!0,updateComponentsBottomSheet:null,onCloseVariations:null,onCreateQuestionFromAi:null,showSnackbar:null,showVariationsError:null,noScrolling:!1},e.exports=P},65346:e=>{const a={DEPRECATED_MSG_LOADED:"vpp:iframe-modal:loaded",DEPRECATED_MSG_CLOSE:"vpp:iframe-modal:close",DEPRECATED_MSG_SNACKBAR:"vpp:iframe-modal:snackbar",DEPRECATED_MSG_NAVIGATE:"vpp:iframe-modal:navigate",DEPRECATED_MSG_REDIRECT:"vpp:iframe-modal:redirect",MSG_LOADED:"vpp:on-demand-iframe:loaded",MSG_CLOSE:"vpp:on-demand-iframe:close",MSG_CLOSABLE:"vpp:on-demand-iframe:closable",MSG_SNACKBAR:"vpp:on-demand-iframe:snackbar",MSG_NAVIGATE:"vpp:on-demand-iframe:navigate",MSG_REDIRECT:"vpp:on-demand-iframe:redirect",MSG_ASK_SELLER:"vpp:on-demand-iframe:ask-seller",MSG_SCROLL_TO_ELEMENT:"vpp:on-demand-iframe:scroll-to-element"};e.exports={eventTypes:a,KEY_TRACKS:{INITIAL_LOAD:"initial_load",WEBVIEW_EVENT:"webview_event"}}},35122:(e,a,o)=>{"object"==typeof window?e.exports=window:e.exports=o.g},81762:(e,a,o)=>{const{onIframeModalResize:t}=o(57122);e.exports=t},81821:(e,a,o)=>{const{targetHostnameValidator:t}=o(57122);e.exports=t}}]);
//# sourceMappingURL=components-on-demand-iframe.5faead07.js.map